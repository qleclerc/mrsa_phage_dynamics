# The dual nature of bacteriophage: growth-dependent predation and generalised transduction of antimicrobial resistance: Code Repository

## About
This repository contains all the code used to run the analyses outlined in the corresponding paper.
Please note that this work is not yet peer-reviewed, and is available [here](www.biorxiv.org).

For any questions, please contact Quentin Leclerc.

- Email: quentin.leclerc@lshtm.ac.uk
- Twitter: [QuentinLclrc](https://twitter.com/QuentinLclrc)

## Data

The "/Data" folder contains

## Model

The core model code is in the "/Model" folder. The skeletons of the growth model (no phage, bacteria only) and transduction model are respectively stored in the files `growth_model.rds` and `transduction_model.rds`, generated by the scripts `growth_fitmodel.R` and `transduction_fitmodel.R`.

These models are designed to work within the `R` package `fitR`, please refer to the package [here](https://github.com/sbfnk/fitR) for further documentation.

The `transduction_model_functions.R` script contains essential functions to work with the transduction model:
- `choose_model()`: when first loaded, the transduction model is by default incomplete. You can flexibly choose the features of the model by running it through the `choose_model()` function. Below is an example to set the model to be frequency-depedent, with a link between phage burst size and bacterial growth. Please refer to the script for detals on further options available.

``` r
#load the model skeleton:
model = readRDS(here::here("Model", "transduction_model.rds"))

#define the model:
model = choose_model(model,                   #provide model
                     frequentist = TRUE       #should the model be frequency-dependent? Otherwise, will be density-dependent
                     link_beta = FALSE,       #link adsorption rate to bacterial growth?
                     link_L = TRUE,           #link burst size to bacterial growth?
                     transduction = TRUE)     #enable transduction?
                     
#the "model" object is now ready to be used!

``` 

- `run_mcmc()`: wrapper function for the model fitting framework provided by the `fitR` package. This is used in the scripts contained in the folder "\Fitting".
- `multi_run2()`: function used to run the model multiple times, with multiple ways to introduce random variations through parameter sampling or Poisson resampling of model output.


## Fitting

The "/Fitting" folder contains

## Analysis

The "/Analysis" folder contains

## Figures

The "/Figures" folder contains the figures created by the different scripts. Each figure is named according to its position in the paper (e.g. "fig2" is Figure 2 in the paper).

## License

This work is distributed under the MIT license (see LICENSE file).
